# Fresh Harvest - åŠŸèƒ½æ¸…å•ä¸æ•°æ®åº“è¦æ±‚

## ğŸ“‹ å·²å®ç°åŠŸèƒ½åˆ—è¡¨

### 1. âœ… ç”¨æˆ·å¤´åƒä¸Šä¼ åŠŸèƒ½

- **åŠŸèƒ½æè¿°**: ç”¨æˆ·å¯ä»¥ä¸Šä¼ å¤´åƒå›¾ç‰‡ï¼Œæ”¯æŒ Base64 ç¼–ç 
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨: `users`
  - å­—æ®µ: `avatar` (TEXT ç±»å‹)
  - è¯´æ˜: å¿…é¡»æ˜¯ TEXT ç±»å‹æ‰èƒ½å­˜å‚¨ Base64 å›¾ç‰‡æ•°æ®
- **å‰ç«¯é¡µé¢**: `AccountSettings.vue`
- **åç«¯æ¥å£**: `POST /api/user/avatar`

### 2. âœ… è´­ç‰©è½¦å•†å“é€‰æ‹©åŠŸèƒ½

- **åŠŸèƒ½æè¿°**: è´­ç‰©è½¦å•†å“å¯ä»¥å•ç‹¬é€‰ä¸­/å–æ¶ˆï¼Œæ”¯æŒæ‰¹é‡ç»“ç®—
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨: `cart`
  - å­—æ®µ: `selected` (TINYINT(1), DEFAULT 1)
  - è¯´æ˜: 0=æœªé€‰ä¸­ï¼Œ1=é€‰ä¸­
- **å‰ç«¯é¡µé¢**: `Cart.vue`
- **åç«¯æ¥å£**: `PUT /api/cart/:id/select`

### 3. âœ… è¯„ä»·ç‚¹èµ/è¸©åŠŸèƒ½

- **åŠŸèƒ½æè¿°**:
  - ç”¨æˆ·å¯ä»¥å¯¹å•†å“è¯„ä»·è¿›è¡Œç‚¹èµæˆ–è¸©
  - ç‚¹èµå’Œè¸©äº’æ–¥ï¼ˆç‚¹äº†èµä¸èƒ½è¸©ï¼Œåä¹‹äº¦ç„¶ï¼‰
  - å¯ä»¥å–æ¶ˆç‚¹èµ/è¸©
  - åˆ·æ–°åä¿æŒç”¨æˆ·çš„æ“ä½œçŠ¶æ€
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨1: `reviews`
    - å­—æ®µ: `likes` (INT, NOT NULL, DEFAULT 0) - ç‚¹èµæ•°
    - å­—æ®µ: `dislikes` (INT, NOT NULL, DEFAULT 0) - è¸©æ•°
  - è¡¨2: `review_likes` (æ–°å»ºè¡¨)
    - å­—æ®µ: `id` (INT, ä¸»é”®, è‡ªå¢)
    - å­—æ®µ: `review_id` (INT, è¯„ä»·ID)
    - å­—æ®µ: `user_id` (INT, ç”¨æˆ·ID)
    - å­—æ®µ: `type` (TINYINT, 1=ç‚¹èµ, -1=è¸©)
    - å­—æ®µ: `created_at` (TIMESTAMP)
    - å”¯ä¸€ç´¢å¼•: `unique_user_review` (review_id, user_id)
    - ç´¢å¼•: `idx_review_id`, `idx_user_id`
- **å‰ç«¯é¡µé¢**:
  - `ProductDetail.vue` - å•†å“è¯¦æƒ…é¡µçš„è¯„ä»·
  - `Home.vue` - é¦–é¡µçš„å®¢æˆ·è¯„ä»·
- **åç«¯æ¥å£**:
  - `POST /api/reviews/:id/like`
  - `POST /api/reviews/:id/dislike`

### 4. âœ… ç‰©æµè¿½è¸ªåŠŸèƒ½

- **åŠŸèƒ½æè¿°**: è®¢å•å‘è´§åå¯ä»¥æŸ¥çœ‹ç‰©æµä¿¡æ¯å’Œè¿½è¸ªå·
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨: `orders`
  - å­—æ®µ: `tracking_number` (VARCHAR(50), DEFAULT NULL)
  - ç´¢å¼•: `idx_tracking_number`
- **å‰ç«¯é¡µé¢**: `OrderDetail.vue`, `OrderList.vue`
- **åç«¯æ¥å£**: `GET /api/orders/:id/logistics`

### 5. âœ… ç”¨æˆ·è®¤è¯ä¸è·¯ç”±å®ˆå«

- **åŠŸèƒ½æè¿°**: è´­ç‰©è½¦ç­‰é¡µé¢éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®
- **æ•°æ®åº“è¦æ±‚**: ä¾èµ– `users` è¡¨
- **å‰ç«¯é¡µé¢**: æ‰€æœ‰éœ€è¦ç™»å½•çš„é¡µé¢
- **è·¯ç”±é…ç½®**: `router/index.js` - `meta.requiresAuth`

### 6. âœ… å•†å“å›¾ç‰‡ç®¡ç†

- **åŠŸèƒ½æè¿°**: å•†å“å±•ç¤ºå›¾ç‰‡
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨: `products`
  - å­—æ®µ: `image_url` (VARCHAR)
  - æ³¨æ„: å­—æ®µåæ˜¯ `image_url` ä¸æ˜¯ `image`
- **å‰ç«¯é¡µé¢**: `Shop.vue`, `ProductDetail.vue`, `Home.vue`

### 7. âœ… è®¢å•ç®¡ç†å®Œæ•´åŠŸèƒ½

- **åŠŸèƒ½æè¿°**: è®¢å•åˆ›å»ºã€çŠ¶æ€è·Ÿè¸ªã€å†å²è®°å½•
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨: `orders`, `order_items`, `order_status_history`
  - ç´¢å¼•:
    - `idx_user_status` (user_id, status)
    - `idx_user_status_created` (user_id, status, created_at)
    - `idx_product_name` (order_items è¡¨)
    - `idx_order_created` (order_status_history è¡¨)
- **å‰ç«¯é¡µé¢**: `OrderList.vue`, `OrderDetail.vue`, `Checkout.vue`

### 8. âœ… æ”¶è—å¤¹åŠŸèƒ½

- **åŠŸèƒ½æè¿°**: ç”¨æˆ·å¯ä»¥æ”¶è—å•†å“
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨: `favorites`
  - ç´¢å¼•: `idx_user_product_fav` (user_id, product_id)
- **å‰ç«¯é¡µé¢**: `Favorites.vue`

### 9. âœ… åœ°å€ç®¡ç†

- **åŠŸèƒ½æè¿°**: ç”¨æˆ·å¯ä»¥ç®¡ç†æ”¶è´§åœ°å€
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨: `addresses`
  - ç´¢å¼•: `idx_user_id`, `idx_is_default`
- **å‰ç«¯é¡µé¢**: `AddressManagement.vue`, `Checkout.vue`

### 10. âœ… é¦–é¡µè½®æ’­å›¾

- **åŠŸèƒ½æè¿°**: é¦–é¡µå±•ç¤ºè½®æ’­å¹¿å‘Š
- **æ•°æ®åº“è¦æ±‚**:
  - è¡¨: `banners`
- **å‰ç«¯é¡µé¢**: `Home.vue`

## ğŸ—„ï¸ æ•°æ®åº“å®Œæ•´æ€§æ£€æŸ¥

### å¿…éœ€çš„è¡¨ (12ä¸ª)

1. âœ… `users` - ç”¨æˆ·è¡¨
2. âœ… `products` - å•†å“è¡¨
3. âœ… `categories` - åˆ†ç±»è¡¨
4. âœ… `orders` - è®¢å•è¡¨
5. âœ… `order_items` - è®¢å•é¡¹è¡¨
6. âœ… `order_status_history` - è®¢å•çŠ¶æ€å†å²è¡¨
7. âœ… `cart` - è´­ç‰©è½¦è¡¨
8. âœ… `favorites` - æ”¶è—è¡¨
9. âœ… `reviews` - è¯„ä»·è¡¨
10. âœ… `review_likes` - è¯„ä»·ç‚¹èµè¡¨ **ï¼ˆé‡è¦ï¼æ–°å¢ï¼‰**
11. âœ… `addresses` - åœ°å€è¡¨
12. âœ… `banners` - è½®æ’­å›¾è¡¨

### å…³é”®å­—æ®µä¿®æ”¹

- `users.avatar` â†’ TEXT ç±»å‹
- `cart.selected` â†’ TINYINT(1) DEFAULT 1
- `reviews.likes` â†’ INT NOT NULL DEFAULT 0
- `reviews.dislikes` â†’ INT NOT NULL DEFAULT 0
- `orders.tracking_number` â†’ VARCHAR(50)
- `products.image_url` â†’ VARCHAR (æ³¨æ„ä¸æ˜¯ `image`)

### é‡è¦ç´¢å¼•

- `orders`: idx_tracking_number, idx_user_status, idx_user_status_created
- `cart`: idx_user_product
- `favorites`: idx_user_product_fav
- `products`: idx_sales_count
- `order_items`: idx_product_name
- `order_status_history`: idx_order_created
- `review_likes`: unique_user_review, idx_review_id, idx_user_id

## ğŸ“ SQL è„šæœ¬æ–‡ä»¶è¯´æ˜

### æ£€æŸ¥è„šæœ¬

- **`database-complete-check.sql`** - å®Œæ•´çš„æ•°æ®åº“ç»“æ„æ£€æŸ¥è„šæœ¬
  - æ£€æŸ¥æ‰€æœ‰å¿…éœ€çš„è¡¨
  - æ£€æŸ¥å…³é”®å­—æ®µç±»å‹
  - æ£€æŸ¥ç´¢å¼•æ˜¯å¦å­˜åœ¨
  - æ£€æŸ¥æ•°æ®å®Œæ•´æ€§

### ä¿®å¤è„šæœ¬

- **`database-complete-fix.sql`** - å®Œæ•´çš„æ•°æ®åº“ä¿®å¤è„šæœ¬
  - ä¿®å¤æ‰€æœ‰ç¼ºå¤±çš„å­—æ®µ
  - åˆ›å»ºç¼ºå¤±çš„è¡¨
  - æ·»åŠ æ‰€æœ‰å¿…éœ€çš„ç´¢å¼•
  - ç”Ÿæˆæµ‹è¯•æ•°æ®ï¼ˆç‰©æµå•å·ï¼‰

### å…¶ä»–è„šæœ¬

- `database-update.sql` - æ•°æ®åº“å‡çº§è„šæœ¬ï¼ˆå¸¦æ£€æŸ¥é€»è¾‘ï¼‰
- `database-optimization.sql` - æ€§èƒ½ä¼˜åŒ–è„šæœ¬
- `create-review-likes-table.sql` - å•ç‹¬åˆ›å»º review_likes è¡¨
- `database-cart-selected-fix.sql` - å•ç‹¬ä¿®å¤è´­ç‰©è½¦é€‰æ‹©å­—æ®µ
- `update-product-images.sql` - æ›´æ–°å•†å“å›¾ç‰‡é“¾æ¥

## ğŸš€ æ•°æ®åº“æ¢å¤æ­¥éª¤

### 1. è¿è¡Œæ£€æŸ¥è„šæœ¬

```bash
# åœ¨ phpMyAdmin æˆ– MySQL å®¢æˆ·ç«¯æ‰§è¡Œ
database-complete-check.sql
```

### 2. è¿è¡Œä¿®å¤è„šæœ¬

```bash
# åœ¨ phpMyAdmin æˆ– MySQL å®¢æˆ·ç«¯æ‰§è¡Œ
database-complete-fix.sql
```

### 3. éªŒè¯ä¿®å¤ç»“æœ

```bash
# å†æ¬¡è¿è¡Œæ£€æŸ¥è„šæœ¬ç¡®è®¤æ‰€æœ‰é—®é¢˜å·²è§£å†³
database-complete-check.sql
```

### 4. é‡å¯åç«¯æœåŠ¡

```bash
node app.js
```

### 5. æµ‹è¯•åŠŸèƒ½

- âœ… ç™»å½•/æ³¨å†Œ
- âœ… ä¸Šä¼ å¤´åƒ
- âœ… æµè§ˆå•†å“
- âœ… æ·»åŠ è´­ç‰©è½¦
- âœ… é€‰æ‹©è´­ç‰©è½¦å•†å“
- âœ… æäº¤è®¢å•
- âœ… æŸ¥çœ‹ç‰©æµ
- âœ… è¯„ä»·å•†å“
- âœ… ç‚¹èµ/è¸©è¯„ä»·
- âœ… æ”¶è—å•†å“
- âœ… ç®¡ç†åœ°å€

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: avatar å­—æ®µå¤ªå°å¯¼è‡´ä¸Šä¼ å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**: è¿è¡Œ `database-complete-fix.sql` å°†å­—æ®µæ”¹ä¸º TEXT ç±»å‹

### Q2: è´­ç‰©è½¦é€‰æ‹©åŠŸèƒ½æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**: è¿è¡Œ `database-complete-fix.sql` æ·»åŠ  `selected` å­—æ®µ

### Q3: è¯„ä»·ç‚¹èµåŠŸèƒ½ä¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**:

1. è¿è¡Œ `database-complete-fix.sql` åˆ›å»º `review_likes` è¡¨
2. ç¡®ä¿ `reviews` è¡¨æœ‰ `likes` å’Œ `dislikes` å­—æ®µ

### Q4: å•†å“å›¾ç‰‡æ›´æ–°å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**: ç¡®è®¤ä½¿ç”¨ `image_url` å­—æ®µåï¼Œä¸æ˜¯ `image`

### Q5: æ€§èƒ½é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**: è¿è¡Œ `database-optimization.sql` æ·»åŠ æ‰€æœ‰ç´¢å¼•

## ğŸ“Š UIç»„ä»¶ä½¿ç”¨

### Element Plus ç»„ä»¶

- âœ… æ‰€æœ‰æŒ‰é’®ä½¿ç”¨ `el-button` åŸç”Ÿç»„ä»¶
- âœ… è¡¨å•ä½¿ç”¨ `el-form`, `el-input`, `el-select` ç­‰
- âœ… å›¾æ ‡ä½¿ç”¨ `@element-plus/icons-vue`
- âœ… æ¶ˆæ¯æç¤ºä½¿ç”¨ `ElMessage`, `ElMessageBox`

### å·²åˆ é™¤çš„æ— ç”¨ç»„ä»¶

- âŒ `Header.vue` (å·²è¢« `Breadcrumb.vue` æ›¿ä»£)
- âŒ `ProductCard.vue` (æœªä½¿ç”¨)

## ğŸ¨ é¡µé¢æ ·å¼ä¼˜åŒ–

### å·²ä¼˜åŒ–é¡µé¢

- âœ… `Login.vue` - ç™»å½•æ³¨å†Œé¡µé¢ï¼ˆä½¿ç”¨ Element Plus æ ·å¼ï¼‰
- âœ… `Cart.vue` - è´­ç‰©è½¦é¡µé¢ï¼ˆä½¿ç”¨ Element Plus æŒ‰é’®ï¼‰
- âœ… `Shop.vue` - å•†å“åˆ—è¡¨é¡µé¢ï¼ˆä¿®å¤æè¿°æ˜¾ç¤ºé—®é¢˜ï¼‰
- âœ… `ProductDetail.vue` - å•†å“è¯¦æƒ…é¡µé¢ï¼ˆè¯„ä»·äº’åŠ¨åŠŸèƒ½ï¼‰
- âœ… `Home.vue` - é¦–é¡µï¼ˆå®¢æˆ·è¯„ä»·äº’åŠ¨åŠŸèƒ½ï¼‰
- âœ… `Checkout.vue` - ç»“ç®—é¡µé¢
- âœ… `OrderDetail.vue` - è®¢å•è¯¦æƒ…é¡µé¢
- âœ… `NotFound.vue` - 404é¡µé¢

æ‰€æœ‰é¡µé¢éƒ½å·²ä½¿ç”¨ Element Plus åŸç”ŸæŒ‰é’®æ ·å¼ï¼Œç¡®ä¿UIä¸€è‡´æ€§ï¼
